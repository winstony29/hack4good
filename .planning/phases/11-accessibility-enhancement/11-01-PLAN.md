---
phase: 11-accessibility-enhancement
plan: 01
type: execute
---

<objective>
Create a floating accessibility toolbar with text size, high contrast, readable font, and reduce motion controls.

Purpose: Provide cognitive accessibility features for users with intellectual disabilities - making the platform usable for everyone.
Output: Floating accessibility button (bottom-right), expandable panel with controls, persistent preferences.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/phases/10-design-foundation/10-01-SUMMARY.md
@.planning/phases/10-design-foundation/10-02-SUMMARY.md

**Design Specification:**
Floating Accessibility Toolbar (bottom-right corner):
- Text size controls (A- / A / A+)
- High contrast toggle (black bg, yellow text)
- Readable font toggle (OpenDyslexic)
- Reduce motion toggle
- Reset button

**Existing accessibility context:**
@frontend/src/contexts/AccessibilityContext.jsx
@frontend/src/components/accessibility/AccessibilityMenu.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FloatingAccessibilityButton component</name>
  <files>frontend/src/components/accessibility/FloatingAccessibilityButton.jsx</files>
  <action>
Create a new component that renders a floating accessibility button in the bottom-right corner:

```jsx
import { useState } from 'react'
import { Accessibility, X } from 'lucide-react'
import { motion, AnimatePresence } from 'framer-motion'
import { useAccessibility } from '../../contexts/AccessibilityContext'
import AccessibilityPanel from './AccessibilityPanel'

export default function FloatingAccessibilityButton() {
  const [isOpen, setIsOpen] = useState(false)
  const { reduceMotion } = useAccessibility()

  return (
    <div className="fixed bottom-6 right-6 z-50">
      <AnimatePresence>
        {isOpen && (
          <AccessibilityPanel
            onClose={() => setIsOpen(false)}
            reduceMotion={reduceMotion}
          />
        )}
      </AnimatePresence>

      <motion.button
        onClick={() => setIsOpen(!isOpen)}
        className={`
          w-14 h-14 rounded-full
          bg-minds-coral text-white
          shadow-lg hover:shadow-xl
          flex items-center justify-center
          focus:outline-none focus:ring-4 focus:ring-minds-coral/50
        `}
        whileHover={!reduceMotion ? { scale: 1.05 } : undefined}
        whileTap={!reduceMotion ? { scale: 0.95 } : undefined}
        aria-label={isOpen ? 'Close accessibility menu' : 'Open accessibility menu'}
        aria-expanded={isOpen}
      >
        {isOpen ? <X size={24} /> : <Accessibility size={24} />}
      </motion.button>
    </div>
  )
}
```

This provides the floating trigger button. Touch target is 56px (14 * 4) which exceeds 48px minimum.
  </action>
  <verify>Component renders floating button at bottom-right, opens/closes on click</verify>
  <done>FloatingAccessibilityButton created with 56px touch target, aria attributes, coral styling</done>
</task>

<task type="auto">
  <name>Task 2: Create AccessibilityPanel component</name>
  <files>frontend/src/components/accessibility/AccessibilityPanel.jsx</files>
  <action>
Create a panel that appears above the floating button with accessibility controls:

```jsx
import { motion } from 'framer-motion'
import { Type, Sun, Eye, Zap, RotateCcw } from 'lucide-react'
import { useAccessibility } from '../../contexts/AccessibilityContext'
import { useTranslation } from '../../hooks/useTranslation'

export default function AccessibilityPanel({ onClose, reduceMotion }) {
  const {
    fontSize,
    setFontSize,
    contrast,
    setContrast,
    readableFont,
    setReadableFont,
    setReduceMotion,
  } = useAccessibility()
  const { t } = useTranslation()

  const handleReset = () => {
    setFontSize('medium')
    setContrast('normal')
    setReadableFont(false)
    setReduceMotion(false)
  }

  const panelVariants = reduceMotion
    ? { initial: { opacity: 1 }, animate: { opacity: 1 }, exit: { opacity: 0 } }
    : {
        initial: { opacity: 0, y: 20, scale: 0.95 },
        animate: { opacity: 1, y: 0, scale: 1 },
        exit: { opacity: 0, y: 20, scale: 0.95 },
      }

  return (
    <motion.div
      {...panelVariants}
      transition={{ duration: reduceMotion ? 0 : 0.2 }}
      className="absolute bottom-20 right-0 w-72 bg-white rounded-2xl shadow-xl border border-minds-border p-5"
      role="dialog"
      aria-label={t('accessibility.settings')}
    >
      <h3 className="text-lg font-bold text-minds-charcoal mb-4 flex items-center gap-2">
        <Eye className="w-5 h-5 text-minds-coral" />
        {t('accessibility.settings')}
      </h3>

      {/* Text Size */}
      <div className="mb-5">
        <label className="text-sm font-semibold text-minds-charcoal mb-2 block">
          {t('accessibility.fontSize')}
        </label>
        <div className="flex gap-2">
          {['small', 'medium', 'large'].map((size) => (
            <button
              key={size}
              onClick={() => setFontSize(size)}
              className={`
                flex-1 py-2.5 rounded-xl font-semibold
                transition-colors min-h-[44px]
                ${fontSize === size
                  ? 'bg-minds-coral text-white'
                  : 'bg-gray-100 text-minds-charcoal hover:bg-gray-200'}
              `}
              aria-pressed={fontSize === size}
            >
              {size === 'small' ? 'A-' : size === 'medium' ? 'A' : 'A+'}
            </button>
          ))}
        </div>
      </div>

      {/* High Contrast Toggle */}
      <div className="mb-5">
        <ToggleSwitch
          label={t('accessibility.highContrast')}
          icon={<Sun className="w-4 h-4" />}
          checked={contrast === 'high'}
          onChange={(checked) => setContrast(checked ? 'high' : 'normal')}
        />
      </div>

      {/* Readable Font Toggle */}
      <div className="mb-5">
        <ToggleSwitch
          label={t('accessibility.readableFont')}
          icon={<Type className="w-4 h-4" />}
          checked={readableFont}
          onChange={setReadableFont}
        />
      </div>

      {/* Reduce Motion Toggle */}
      <div className="mb-5">
        <ToggleSwitch
          label={t('accessibility.reduceMotion')}
          icon={<Zap className="w-4 h-4" />}
          checked={reduceMotion}
          onChange={setReduceMotion}
        />
      </div>

      {/* Reset Button */}
      <button
        onClick={handleReset}
        className="w-full py-2.5 rounded-xl border-2 border-minds-border text-minds-gray hover:bg-gray-50 font-medium flex items-center justify-center gap-2 min-h-[44px]"
      >
        <RotateCcw className="w-4 h-4" />
        {t('accessibility.reset')}
      </button>
    </motion.div>
  )
}

function ToggleSwitch({ label, icon, checked, onChange }) {
  return (
    <div className="flex items-center justify-between">
      <span className="text-sm font-medium text-minds-charcoal flex items-center gap-2">
        {icon}
        {label}
      </span>
      <button
        role="switch"
        aria-checked={checked}
        onClick={() => onChange(!checked)}
        className={`
          relative w-12 h-7 rounded-full transition-colors
          focus:outline-none focus:ring-2 focus:ring-minds-coral focus:ring-offset-2
          ${checked ? 'bg-minds-coral' : 'bg-gray-300'}
        `}
      >
        <span
          className={`
            absolute top-0.5 left-0.5 w-6 h-6 bg-white rounded-full
            transition-transform shadow-md
            ${checked ? 'translate-x-5' : 'translate-x-0'}
          `}
        />
      </button>
    </div>
  )
}
```

This panel provides all accessibility controls in a clean, touch-friendly interface.
  </action>
  <verify>Panel appears with all controls, toggles work, reset clears all settings</verify>
  <done>AccessibilityPanel with text size, contrast, readable font, motion, and reset controls</done>
</task>

<task type="auto">
  <name>Task 3: Update AccessibilityContext with readableFont state</name>
  <files>frontend/src/contexts/AccessibilityContext.jsx</files>
  <action>
Read the current AccessibilityContext and add `readableFont` state if not present. Also ensure it applies CSS data attributes to document.documentElement:

Add to the context state:
```js
const [readableFont, setReadableFont] = useState(() => {
  const saved = localStorage.getItem('a11y-readable-font')
  return saved === 'true'
})
```

Add useEffect to apply CSS data attributes for high contrast and readable font:
```js
useEffect(() => {
  const root = document.documentElement

  // Apply contrast mode
  if (contrast === 'high') {
    root.setAttribute('data-contrast', 'high')
  } else {
    root.removeAttribute('data-contrast')
  }

  // Apply readable font
  if (readableFont) {
    root.setAttribute('data-font', 'dyslexic')
  } else {
    root.removeAttribute('data-font')
  }
}, [contrast, readableFont])

// Save readableFont to localStorage
useEffect(() => {
  localStorage.setItem('a11y-readable-font', readableFont.toString())
}, [readableFont])
```

Add to the context value:
```js
readableFont,
setReadableFont,
```

This enables the CSS custom property toggles we set up in Phase 10.
  </action>
  <verify>Context provides readableFont state, toggles apply data attributes to html element</verify>
  <done>AccessibilityContext includes readableFont, applies data-contrast and data-font attributes to document</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd frontend && npm run build` succeeds
- [ ] Floating button appears bottom-right at 56px size
- [ ] Panel opens with smooth animation (if motion enabled)
- [ ] Text size toggles update the UI
- [ ] High contrast toggle applies black/yellow theme
- [ ] Reduce motion toggle stops animations
- [ ] Reset button clears all settings
- [ ] Settings persist on page reload
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Accessibility toolbar fully functional
- Settings persist in localStorage
</success_criteria>

<output>
After completion, create `.planning/phases/11-accessibility-enhancement/11-01-SUMMARY.md`
</output>
