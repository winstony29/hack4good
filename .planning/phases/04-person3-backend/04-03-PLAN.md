---
phase: 04-person3-backend
plan: 03
type: execute
---

<objective>
Enhance toast notifications in the frontend swiper for better user feedback.

Purpose: Add toast notifications for swipe actions (pass, match, error states)
Output: Consistent toast feedback throughout the swiper experience
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
</execution_context>

<context>
@frontend/src/components/swiper/ActivitySwiper.jsx - Main swiper component
@frontend/src/services/matches.api.js - API service (may need creation)
@frontend/package.json - react-hot-toast already installed
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create matches API service for frontend</name>
  <files>frontend/src/services/matches.api.js</files>
  <action>
    Create a new API service file for matches that integrates with the mock toggle:

    ```javascript
    import api from './api'
    import { USE_MOCK_DATA } from '../utils/env'

    // Mock data for development
    const mockMatches = []

    export const matchesApi = {
      /**
       * Get activities available for matching
       */
      getAvailableActivities: async () => {
        if (USE_MOCK_DATA) {
          // Return mock activities (imported from existing mock)
          const { getAvailableActivitiesMock } = await import('./activities.mock')
          return { data: getAvailableActivitiesMock() }
        }
        return api.get('/matches/available')
      },

      /**
       * Create a volunteer match (swipe right / match button)
       */
      createMatch: async (activityId) => {
        if (USE_MOCK_DATA) {
          // Simulate match creation
          const newMatch = {
            id: crypto.randomUUID(),
            volunteer_id: 'mock-volunteer-id',
            activity_id: activityId,
            status: 'confirmed',
            matched_at: new Date().toISOString()
          }
          mockMatches.push(newMatch)
          // Simulate network delay
          await new Promise(resolve => setTimeout(resolve, 300))
          return { data: newMatch }
        }
        return api.post('/matches', { activity_id: activityId })
      },

      /**
       * Get volunteer's matches
       */
      getMyMatches: async (userId) => {
        if (USE_MOCK_DATA) {
          return { data: mockMatches }
        }
        return api.get(`/matches/user/${userId}`)
      },

      /**
       * Cancel a match
       */
      cancelMatch: async (matchId) => {
        if (USE_MOCK_DATA) {
          const index = mockMatches.findIndex(m => m.id === matchId)
          if (index !== -1) {
            mockMatches[index].status = 'cancelled'
          }
          return { data: null }
        }
        return api.delete(`/matches/${matchId}`)
      }
    }
    ```
  </action>
  <verify>
    - File created at frontend/src/services/matches.api.js
    - Exports matchesApi object with 4 methods
    - Respects USE_MOCK_DATA toggle
  </verify>
  <done>Matches API service created with mock support</done>
</task>

<task type="auto">
  <name>Task 2: Add toast notifications to ActivitySwiper</name>
  <files>frontend/src/components/swiper/ActivitySwiper.jsx</files>
  <action>
    Update ActivitySwiper to show toast notifications for swipe actions:

    1. Add import at top:
    ```javascript
    import toast from 'react-hot-toast'
    ```

    2. Update the handleSwipe function to show toasts:
    ```javascript
    const handleSwipe = async (direction, activity) => {
      if (direction === 'right') {
        // Match - show success toast
        toast.success(`Matched with "${activity.title}"!`, {
          duration: 3000,
          icon: 'ðŸŽ‰'
        })
      } else {
        // Pass - show info toast (subtle, short)
        toast(`Passed on "${activity.title}"`, {
          duration: 1500,
          icon: 'ðŸ‘‹',
          style: {
            background: '#f3f4f6',
            color: '#6b7280'
          }
        })
      }
      // ... rest of existing logic
    }
    ```

    3. Add error handling with toast:
    ```javascript
    // Wrap API calls in try/catch
    try {
      // API call...
    } catch (error) {
      toast.error('Something went wrong. Please try again.', {
        duration: 4000
      })
      console.error('Swipe error:', error)
    }
    ```

    4. Add toast when all cards are swiped:
    ```javascript
    // When activities array is empty
    if (activities.length === 0) {
      toast('No more activities to browse!', {
        icon: 'âœ¨',
        duration: 3000
      })
    }
    ```

    Note: The exact implementation depends on existing ActivitySwiper structure.
    Key principle: Success = green toast, Pass = gray toast, Error = red toast
  </action>
  <verify>
    - Toast appears on swipe right (match)
    - Toast appears on swipe left (pass)
    - Error toast appears on API failure
    - No duplicate toasts for same action
  </verify>
  <done>ActivitySwiper shows appropriate toasts for all swipe states</done>
</task>

<task type="auto">
  <name>Task 3: Configure toast styling for accessibility</name>
  <files>frontend/src/main.jsx</files>
  <action>
    Ensure Toaster component is configured with good defaults in main.jsx:

    Check if Toaster is already in main.jsx or App.jsx. If not, add it:

    ```javascript
    import { Toaster } from 'react-hot-toast'

    // Inside the render, add:
    <Toaster
      position="top-center"
      gutter={8}
      toastOptions={{
        // Default options for all toasts
        duration: 3000,
        style: {
          background: 'var(--a11y-card-bg, #fff)',
          color: 'var(--a11y-text, #1f2937)',
          fontSize: 'var(--a11y-font-size, 16px)',
        },
        // Success toast styling
        success: {
          iconTheme: {
            primary: '#10b981',
            secondary: '#fff',
          },
        },
        // Error toast styling
        error: {
          iconTheme: {
            primary: '#ef4444',
            secondary: '#fff',
          },
          duration: 4000,
        },
      }}
    />
    ```

    The CSS variables (--a11y-*) allow toasts to respect accessibility settings.
  </action>
  <verify>
    - Toaster component is in the React tree
    - Toasts respect accessibility CSS variables
    - Position is visible and not obstructing content
  </verify>
  <done>Toaster configured with accessibility-aware styling</done>
</task>

<task type="auto">
  <name>Task 4: Add loading toast for async operations</name>
  <files>frontend/src/components/swiper/ActivitySwiper.jsx</files>
  <action>
    Use toast.promise for async operations to show loading states:

    ```javascript
    // When creating a match via API
    const createMatchWithToast = async (activityId, activityTitle) => {
      await toast.promise(
        matchesApi.createMatch(activityId),
        {
          loading: 'Confirming match...',
          success: `Matched with "${activityTitle}"!`,
          error: 'Failed to create match. Please try again.'
        },
        {
          success: {
            icon: 'ðŸŽ‰',
            duration: 3000
          }
        }
      )
    }
    ```

    This provides:
    - Loading spinner while API call is in progress
    - Success message on completion
    - Error message if it fails

    Only use for actual API calls, not for mock mode quick responses.
  </action>
  <verify>
    - Loading toast appears during API calls
    - Transitions to success/error appropriately
    - Mock mode still works smoothly (may skip loading for instant responses)
  </verify>
  <done>Async operations show loading/success/error toasts</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] matches.api.js created with mock support
- [ ] ActivitySwiper imports and uses toast
- [ ] Toaster component configured in app root
- [ ] Swipe right shows success toast
- [ ] Swipe left shows pass toast
- [ ] API errors show error toast
- [ ] Toasts respect accessibility CSS variables
</verification>

<success_criteria>
- Every swipe action has feedback
- Errors are clearly communicated
- Toasts don't block user interaction
- Styling respects accessibility settings
- No console errors
</success_criteria>

<output>
After completion, create `.planning/phases/04-person3-backend/04-03-SUMMARY.md`
</output>
