---
phase: 01-volunteer-swiper
plan: 02
type: execute
---

<objective>
Integrate mock data with the matches API for seamless development/production switching.

Purpose: Enable swiper to work with mock data now, real API later without code changes
Output: Updated matches.api.js with mock toggle, new getAvailableActivitiesMock function
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
</execution_context>

<context>
@.planning/PERSON3-VOLUNTEER-SWIPER-DESIGN.md
@frontend/src/utils/env.js
@frontend/src/services/matches.api.js
@frontend/src/mocks/volunteerMatches.mock.js
@frontend/src/mocks/activities.mock.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add getAvailableActivitiesMock function</name>
  <files>frontend/src/mocks/volunteerMatches.mock.js</files>
  <action>
    Add a new function `getAvailableActivitiesMock` that returns activities the volunteer hasn't matched with yet.

    At the top, after existing imports add:
    ```javascript
    import { mockActivities } from './activities.mock'
    ```

    Add new function (after getMatchesByActivity):
    ```javascript
    /**
     * Get activities available for volunteer to swipe on
     * Excludes activities they've already matched with
     * Only returns future activities (date >= today)
     */
    export const getAvailableActivitiesMock = (volunteerId = 'user-3') => {
      const today = new Date().toISOString().split('T')[0]

      // Get IDs of activities volunteer already matched with
      const matchedActivityIds = mockVolunteerMatches
        .filter(match => match.volunteer_id === volunteerId && match.status === 'confirmed')
        .map(match => match.activity_id)

      // Return future activities not yet matched
      return mockActivities.filter(activity =>
        activity.date >= today &&
        !matchedActivityIds.includes(activity.id)
      )
    }
    ```

    The function:
    - Filters out past activities (date < today)
    - Filters out activities volunteer already matched with
    - Returns array of activity objects ready for swiper
  </action>
  <verify>
    - Function exists in volunteerMatches.mock.js
    - Importing and calling `getAvailableActivitiesMock()` returns array of activities
    - Returned activities don't include match-1 activity (id='3') or match-2 activity (id='7')
  </verify>
  <done>getAvailableActivitiesMock function added and returns filtered activities</done>
</task>

<task type="auto">
  <name>Task 2: Update matches.api.js with mock toggle</name>
  <files>frontend/src/services/matches.api.js</files>
  <action>
    Refactor matches.api.js to use environment-based mock toggle.

    Replace entire file with:
    ```javascript
    import api, { createCrudApi } from './api'
    import { USE_MOCK_DATA } from '../utils/env'
    import {
      getAvailableActivitiesMock,
      createVolunteerMatch,
      cancelVolunteerMatch,
      getVolunteerMatches
    } from '../mocks/volunteerMatches.mock'

    export const matchesApi = {
      // Get available activities for swiping
      getAvailable: async () => {
        if (USE_MOCK_DATA) {
          const activities = getAvailableActivitiesMock()
          return { data: activities }
        }
        return api.get('/matches/available')
      },

      // Create a new match (volunteer signs up)
      create: async (data) => {
        if (USE_MOCK_DATA) {
          const match = createVolunteerMatch(data)
          return { data: match }
        }
        return api.post('/matches', data)
      },

      // Get volunteer's current matches
      getAll: async () => {
        if (USE_MOCK_DATA) {
          const matches = getVolunteerMatches()
          return { data: matches }
        }
        return api.get('/matches')
      },

      // Cancel a match
      cancel: async (matchId) => {
        if (USE_MOCK_DATA) {
          cancelVolunteerMatch(matchId)
          return { data: { success: true } }
        }
        return api.delete(`/matches/${matchId}`)
      }
    }
    ```

    Key points:
    - All methods check USE_MOCK_DATA first
    - Mock functions wrapped to return { data: ... } matching API response shape
    - Same interface whether using mock or real API
    - When Person 2 completes backend, just set VITE_USE_MOCK_DATA=false
  </action>
  <verify>
    - File uses import from '../utils/env'
    - Each method has if (USE_MOCK_DATA) check
    - `npm run dev` starts without import errors
  </verify>
  <done>matches.api.js updated with mock toggle, all methods support both modes</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] getAvailableActivitiesMock exists and returns array of activities
- [ ] matches.api.js imports USE_MOCK_DATA from env.js
- [ ] matches.api.js methods all check USE_MOCK_DATA
- [ ] `npm run dev` starts without errors
- [ ] Opening browser console shows no import errors
</verification>

<success_criteria>
- All tasks completed
- Mock data integration working
- API shape consistent between mock and real
- No console errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-volunteer-swiper/01-02-SUMMARY.md`
</output>
