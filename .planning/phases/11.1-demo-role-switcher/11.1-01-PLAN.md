---
phase: 11.1-demo-role-switcher
type: execute
---

<objective>
Add a floating demo role switcher that lets the presenter instantly switch between Staff, Volunteer, and Participant roles during a live hackathon demo — without logging out or refreshing.

Purpose: The demo flow is: show real login once (proving auth works), demo the staff experience, then announce "I added a role switcher for the demo" and use it to quickly show Volunteer and Participant views. This saves ~2 minutes of login/logout cycling during a 3-minute demo.

Output: A floating UI component (bottom-left, opposite the accessibility toolbar) that swaps the mock user in AuthContext and navigates to the appropriate landing page for each role.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md

**Key files:**
@frontend/src/contexts/AuthContext.jsx — Auth state provider; has USE_MOCK_DATA toggle and setUser
@frontend/src/mocks/users.mock.js — mockUser (participant), mockStaffUser, mockVolunteerUser
@frontend/src/mocks/userSwitcher.mock.js — getCurrentMockUser (currently static, code-change-only switching)
@frontend/src/components/accessibility/AccessibilityToolbar.jsx — Pattern reference for floating toolbar UI
@frontend/src/App.jsx — Where to mount the component (alongside AccessibilityToolbar)

**Established patterns:**
- Floating toolbar: bottom-right fixed position, rounded, expand/collapse (AccessibilityToolbar)
- Auth context: useAuth() hook, user object with user_metadata.role
- Mock users: three pre-defined users in users.mock.js
- Navigation: useNavigate() from react-router-dom
- Icons: lucide-react
- Styling: Tailwind utility classes, minds-coral/minds-teal design tokens

**Constraining decisions:**
- USE_MOCK_DATA is already true on demo-ready branch
- Must not interfere with real auth flow (component only renders when USE_MOCK_DATA is true)
- Must coexist with AccessibilityToolbar (bottom-right) — place role switcher bottom-left
</context>

<tasks>

<task type="auto">
  <name>Task 1: Expose setUser and add switchRole to AuthContext</name>
  <files>frontend/src/contexts/AuthContext.jsx, frontend/src/mocks/userSwitcher.mock.js</files>
  <action>
  In AuthContext.jsx:
  1. Import all three mock users directly: mockUser, mockStaffUser, mockVolunteerUser from users.mock.js
  2. Add a `switchRole` function that accepts a role string ('participant' | 'volunteer' | 'staff'), picks the matching mock user, and calls setUser() with it. Also log the switch via console.log for debugging.
  3. Export `switchRole` in the context value object (alongside user, loading, signup, login, logout, updateUser).
  4. Do NOT change the USE_MOCK_DATA constant or the real auth flow — switchRole only works when USE_MOCK_DATA is true (guard with early return if not mock mode).

  No changes needed to userSwitcher.mock.js — we bypass it by importing users directly.
  </action>
  <verify>No build errors: `npm run build` from frontend/ succeeds. Existing auth flow unchanged — grep for USE_MOCK_DATA confirms guard is intact.</verify>
  <done>AuthContext exports switchRole function. switchRole('staff') sets user to mockStaffUser, switchRole('volunteer') to mockVolunteerUser, switchRole('participant') to mockUser. Only works when USE_MOCK_DATA=true.</done>
</task>

<task type="auto">
  <name>Task 2: Create DemoRoleSwitcher floating component</name>
  <files>frontend/src/components/demo/DemoRoleSwitcher.jsx</files>
  <action>
  Create a new component at frontend/src/components/demo/DemoRoleSwitcher.jsx:

  **Behavior:**
  - Fixed position bottom-left (opposite AccessibilityToolbar which is bottom-right)
  - Collapsed state: small pill/badge showing current role name + colored dot (e.g. "Staff" with a coral dot)
  - Expanded state (on click): shows three role buttons — Staff, Volunteer, Participant — each with a distinct color and icon
  - Clicking a role calls switchRole() from AuthContext, then navigates to the role's home page:
    - Staff → /dashboard
    - Volunteer → /swiper
    - Participant → /activities
  - Current role is visually highlighted (ring/border)
  - Smooth expand/collapse animation using Tailwind transitions (no Framer Motion needed for this simple toggle)
  - "DEMO" label on the collapsed pill so judges know it's a demo tool

  **Styling:**
  - Role colors: Staff = minds-coral (#E07A5F), Volunteer = minds-teal (#2A9D8F), Participant = blue-500
  - Icons from lucide-react: Staff = Shield, Volunteer = Heart, Participant = User
  - Rounded-2xl, shadow-lg, bg-white, same visual quality as AccessibilityToolbar
  - 48px minimum touch targets on role buttons
  - Semi-transparent backdrop when expanded (or just the panel itself)

  **Guard:** Return null if USE_MOCK_DATA is false. Import USE_MOCK_DATA check — either read it from a shared constant or check if switchRole exists in auth context. Simplest: export USE_MOCK_DATA from AuthContext and check it.

  **Do NOT** add this to the accessibility toolbar or combine with it. Keep it separate and independent.
  </action>
  <verify>File exists at frontend/src/components/demo/DemoRoleSwitcher.jsx. No import errors. Component returns null when mock data is off.</verify>
  <done>DemoRoleSwitcher component renders floating pill bottom-left showing current role, expands to three role buttons on click, calls switchRole + navigates on selection.</done>
</task>

<task type="auto">
  <name>Task 3: Mount DemoRoleSwitcher in App.jsx and verify</name>
  <files>frontend/src/App.jsx</files>
  <action>
  1. Import DemoRoleSwitcher in App.jsx
  2. Add it inside the AuthProvider + AccessibilityProvider tree, alongside AccessibilityToolbar (after it, before closing Toaster)
  3. No conditional needed in App.jsx — the component self-guards (returns null when not in mock mode)

  Then verify the full flow works:
  - `npm run dev` starts without errors
  - Component visible bottom-left when USE_MOCK_DATA=true
  - Click to expand, click Staff/Volunteer/Participant to switch
  - User context updates (dashboard changes, navbar reflects role)
  - Navigation goes to correct page per role
  </action>
  <verify>`npm run build` succeeds. `npm run dev` shows the role switcher bottom-left. Clicking each role switches the view.</verify>
  <done>DemoRoleSwitcher mounted in App.jsx, visible in dev server, role switching works end-to-end with navigation.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Floating demo role switcher — bottom-left pill showing current role, expands to Staff/Volunteer/Participant buttons, switches auth context and navigates on click</what-built>
  <how-to-verify>
    1. Run: `cd frontend && npm run dev`
    2. Visit: http://localhost:5173
    3. Look bottom-left: see "DEMO: [Role]" pill
    4. Click it: expands to show three role buttons (Staff, Volunteer, Participant)
    5. Click "Staff": should navigate to /dashboard, show StaffDashboard with analytics
    6. Click role switcher again, click "Volunteer": should navigate to /swiper, show volunteer swiper
    7. Click role switcher again, click "Participant": should navigate to /activities, show activity browsing
    8. Confirm: current role is visually highlighted in the switcher
    9. Confirm: no overlap with accessibility toolbar (bottom-right)
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds in frontend/
- [ ] DemoRoleSwitcher renders bottom-left, does not overlap AccessibilityToolbar
- [ ] Switching roles updates AuthContext user and navigates correctly
- [ ] Component returns null when USE_MOCK_DATA is false (no leakage to prod)
- [ ] No existing functionality broken (auth, dashboard, swiper, activities all work)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Role switcher visible and functional in dev server
- Demo flow works: show login → demo staff → switch to volunteer → switch to participant (no logout needed)
- No regressions to existing features
  </success_criteria>

<output>
After completion, create `.planning/phases/11.1-demo-role-switcher/11.1-01-SUMMARY.md`
</output>
