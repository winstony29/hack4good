---
phase: 07-error-handling-feedback
plan: 02
type: execute
---

<objective>
Add inline form validation feedback and enhance user input experience.

Purpose: Help users correct input errors before submission and provide clear feedback during form interactions.
Output: Forms show real-time validation errors and clear success/error states.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-error-handling-feedback/07-01-PLAN.md

**Codebase context:**
@.planning/codebase/CONVENTIONS.md

**Key files:**
@frontend/src/components/auth/AuthForm.jsx
@frontend/src/components/shared/Input.jsx
@frontend/src/components/activities/ActivityForm.jsx

**Existing patterns:**
- Input component has basic styling
- ActivityDetailModal has validation result display (good pattern)
- AuthForm has basic error handling but no inline validation

**Phase 7-01 deliverables:**
- errorUtils.js with getErrorMessage
- Consistent toast patterns
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance Input component with error state</name>
  <files>frontend/src/components/shared/Input.jsx</files>
  <action>
Add error display capability to Input component:

1. Add new props: `error` (string), `touched` (boolean)
2. When error prop is provided and touched is true, show:
   - Red border on input (border-red-500)
   - Error message below input in red text (text-sm text-red-600)
   - Error icon (AlertCircle from lucide-react) inside input on right
3. Add success state: when touched and no error, show green border briefly

Update component signature:
```javascript
export default function Input({
  label,
  error,
  touched,
  className = '',
  ...props
}) {
```

Add error display below input:
```javascript
{touched && error && (
  <p className="mt-1 text-sm text-red-600 flex items-center gap-1">
    <AlertCircle className="w-4 h-4" />
    {error}
  </p>
)}
```

Ensure focus-within animation from Phase 6 still works.
  </action>
  <verify>
- Check Input component renders without error prop (backwards compatible)
- Add error="Test error" touched={true} - verify red styling appears
- Test with forms that use Input - verify no breaking changes
  </verify>
  <done>
- Input accepts error and touched props
- Error state shows red border and message
- Backwards compatible with existing usage
  </done>
</task>

<task type="auto">
  <name>Task 2: Add inline validation to AuthForm</name>
  <files>frontend/src/components/auth/AuthForm.jsx</files>
  <action>
Add real-time validation to AuthForm:

1. Create validation functions:
```javascript
const validateEmail = (email) => {
  if (!email) return 'Email is required'
  if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) return 'Invalid email format'
  return ''
}

const validatePassword = (password) => {
  if (!password) return 'Password is required'
  if (password.length < 6) return 'Password must be at least 6 characters'
  return ''
}
```

2. Add state for field errors and touched state:
```javascript
const [errors, setErrors] = useState({})
const [touched, setTouched] = useState({})
```

3. Add onBlur handler to mark fields as touched:
```javascript
const handleBlur = (field) => {
  setTouched(prev => ({ ...prev, [field]: true }))
  // Run validation on blur
  if (field === 'email') {
    setErrors(prev => ({ ...prev, email: validateEmail(formData.email) }))
  }
  // etc for other fields
}
```

4. Update Input components to pass error and touched props

5. Disable submit button when form has validation errors:
```javascript
const isFormValid = !validateEmail(formData.email) && !validatePassword(formData.password)
```

6. For signup mode, also validate:
   - Full name required
   - Role selection required
  </action>
  <verify>
- Navigate to /auth
- Enter invalid email, blur field - error appears
- Enter short password, blur - error appears
- Fix errors - errors clear
- Submit with valid data - works as before
- Test both login and signup modes
  </verify>
  <done>
- Email validation on blur
- Password validation on blur
- Signup mode validates name and role
- Submit disabled when errors exist
- Error messages clear when fixed
  </done>
</task>

<task type="auto">
  <name>Task 3: Add validation feedback to ActivityForm</name>
  <files>frontend/src/components/activities/ActivityForm.jsx</files>
  <action>
Add validation to ActivityForm (used by staff to create/edit activities):

1. Add validation for required fields:
   - title: required, max 100 chars
   - description: required
   - date: required, must be future date
   - start_time: required
   - end_time: required, must be after start_time
   - max_participants: required, must be positive number

2. Add touched state tracking similar to AuthForm

3. Update form inputs to show validation errors using enhanced Input component

4. Add form-level error summary at top when multiple errors exist:
```javascript
{Object.values(errors).filter(Boolean).length > 1 && (
  <div className="bg-red-50 border border-red-200 rounded-lg p-3 mb-4">
    <p className="text-sm text-red-800">
      Please fix {Object.values(errors).filter(Boolean).length} errors before submitting
    </p>
  </div>
)}
```

5. Show success feedback briefly after successful save (use toast from 07-01)
  </action>
  <verify>
- Login as staff user
- Navigate to activity creation
- Leave required fields empty, blur - errors appear
- Enter past date - error appears
- Enter end time before start time - error appears
- Fix errors and submit - success toast appears
  </verify>
  <done>
- All required fields validated
- Date/time validation works
- Error summary shows for multiple errors
- Success feedback on save
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Input component error prop works correctly
- [ ] AuthForm shows inline validation errors
- [ ] ActivityForm shows inline validation errors
- [ ] Validation errors clear when fixed
- [ ] Forms still submit successfully with valid data
- [ ] `npm run lint` passes in frontend/
- [ ] `npm run build` succeeds in frontend/
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Forms provide clear feedback before submission
- No regression in form functionality
- Phase 7 complete (both plans done)
</success_criteria>

<output>
After completion, create `.planning/phases/07-error-handling-feedback/07-02-SUMMARY.md`
</output>
