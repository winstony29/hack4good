---
phase: 01-volunteer-swiper
plan: 03
type: execute
---

<objective>
Create SwipeableCard and SwipeButtons components with Framer Motion animations.

Purpose: Build the core swipe interaction with drag gestures and accessible button fallback
Output: SwipeableCard.jsx with drag behavior, SwipeButtons.jsx for accessibility
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
</execution_context>

<context>
@.planning/PERSON3-VOLUNTEER-SWIPER-DESIGN.md
@frontend/src/components/activities/ActivityCard.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SwipeableCard component</name>
  <files>frontend/src/components/volunteer/SwipeableCard.jsx</files>
  <action>
    Create SwipeableCard.jsx with Framer Motion drag gestures:

    ```jsx
    import { motion, useMotionValue, useTransform, useAnimation } from 'framer-motion'
    import ActivityCard from '../activities/ActivityCard'

    const swipeConfidenceThreshold = 100

    export default function SwipeableCard({
      activity,
      onSwipe,
      isTop = false,
      stackIndex = 0
    }) {
      const controls = useAnimation()
      const x = useMotionValue(0)

      // Rotate card based on drag position
      const rotate = useTransform(x, [-200, 0, 200], [-15, 0, 15])

      // Opacity for swipe indicators
      const passOpacity = useTransform(x, [-100, -50, 0], [1, 0.5, 0])
      const matchOpacity = useTransform(x, [0, 50, 100], [0, 0.5, 1])

      // Scale for stacked cards (cards behind are smaller)
      const scale = 1 - stackIndex * 0.05
      const y = stackIndex * 8

      const handleDragEnd = async (event, info) => {
        const { offset, velocity } = info
        const swipePower = Math.abs(offset.x) * velocity.x

        if (swipePower < -swipeConfidenceThreshold * 100 || offset.x < -swipeConfidenceThreshold) {
          // Swipe left - Pass
          await controls.start({
            x: -400,
            opacity: 0,
            rotate: -20,
            transition: { duration: 0.3 }
          })
          onSwipe('left')
        } else if (swipePower > swipeConfidenceThreshold * 100 || offset.x > swipeConfidenceThreshold) {
          // Swipe right - Match
          await controls.start({
            x: 400,
            opacity: 0,
            rotate: 20,
            transition: { duration: 0.3 }
          })
          onSwipe('right')
        } else {
          // Snap back to center
          controls.start({ x: 0, rotate: 0, transition: { type: 'spring', stiffness: 500, damping: 30 } })
        }
      }

      // Programmatic swipe (for button clicks)
      const triggerSwipe = async (direction) => {
        const xTarget = direction === 'right' ? 400 : -400
        const rotateTarget = direction === 'right' ? 20 : -20

        await controls.start({
          x: xTarget,
          opacity: 0,
          rotate: rotateTarget,
          transition: { duration: 0.3 }
        })
        onSwipe(direction)
      }

      return (
        <motion.div
          className="absolute inset-0"
          style={{
            x,
            rotate,
            scale,
            y,
            zIndex: 10 - stackIndex
          }}
          drag={isTop ? 'x' : false}
          dragConstraints={{ left: 0, right: 0 }}
          dragElastic={1}
          onDragEnd={isTop ? handleDragEnd : undefined}
          animate={controls}
        >
          {/* Swipe Indicators */}
          {isTop && (
            <>
              <motion.div
                className="absolute top-8 left-8 bg-red-500 text-white px-6 py-2 rounded-lg font-bold text-xl z-20 rotate-[-15deg]"
                style={{ opacity: passOpacity }}
              >
                PASS
              </motion.div>
              <motion.div
                className="absolute top-8 right-8 bg-green-500 text-white px-6 py-2 rounded-lg font-bold text-xl z-20 rotate-[15deg]"
                style={{ opacity: matchOpacity }}
              >
                MATCH!
              </motion.div>
            </>
          )}

          {/* Activity Card */}
          <div className="h-full">
            <ActivityCard activity={activity} />
          </div>
        </motion.div>
      )
    }

    // Export triggerSwipe method via ref for button access
    SwipeableCard.displayName = 'SwipeableCard'
    ```

    Key features:
    - Drag only enabled on top card (isTop prop)
    - Rotation follows drag direction
    - PASS/MATCH indicators fade in during drag
    - Stack effect with scale/y offset
    - Exit animation on successful swipe
    - Spring snap-back on incomplete swipe
  </action>
  <verify>
    - File exists at frontend/src/components/volunteer/SwipeableCard.jsx
    - No syntax errors (npm run dev compiles)
    - Imports from framer-motion work
  </verify>
  <done>SwipeableCard.jsx created with drag gestures, rotation, indicators, and exit animations</done>
</task>

<task type="auto">
  <name>Task 2: Create SwipeButtons component</name>
  <files>frontend/src/components/volunteer/SwipeButtons.jsx</files>
  <action>
    Create SwipeButtons.jsx for accessible button-based swiping:

    ```jsx
    import { X, Heart } from 'lucide-react'

    export default function SwipeButtons({ onPass, onMatch, disabled = false }) {
      return (
        <div className="flex justify-center gap-8">
          {/* Pass Button */}
          <button
            onClick={onPass}
            disabled={disabled}
            className="w-16 h-16 rounded-full bg-white border-2 border-red-400 text-red-500
                       flex items-center justify-center shadow-lg
                       hover:bg-red-50 hover:border-red-500 hover:scale-110
                       active:scale-95 transition-all duration-200
                       disabled:opacity-50 disabled:cursor-not-allowed
                       focus:outline-none focus:ring-4 focus:ring-red-200"
            aria-label="Pass on this activity"
          >
            <X className="w-8 h-8" strokeWidth={3} />
          </button>

          {/* Match Button */}
          <button
            onClick={onMatch}
            disabled={disabled}
            className="w-16 h-16 rounded-full bg-white border-2 border-green-400 text-green-500
                       flex items-center justify-center shadow-lg
                       hover:bg-green-50 hover:border-green-500 hover:scale-110
                       active:scale-95 transition-all duration-200
                       disabled:opacity-50 disabled:cursor-not-allowed
                       focus:outline-none focus:ring-4 focus:ring-green-200"
            aria-label="Volunteer for this activity"
          >
            <Heart className="w-8 h-8" fill="currentColor" />
          </button>
        </div>
      )
    }
    ```

    Key features:
    - Large 64px touch targets (accessibility)
    - Clear visual distinction (red X / green heart)
    - Hover and active states for feedback
    - Focus rings for keyboard navigation
    - aria-labels for screen readers
    - Disabled state while animating
  </action>
  <verify>
    - File exists at frontend/src/components/volunteer/SwipeButtons.jsx
    - No syntax errors (npm run dev compiles)
    - Lucide icons import works
  </verify>
  <done>SwipeButtons.jsx created with accessible Pass/Match buttons</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] SwipeableCard.jsx exists with Framer Motion imports
- [ ] SwipeButtons.jsx exists with Lucide icons
- [ ] `npm run dev` compiles without errors
- [ ] No import errors in browser console
</verification>

<success_criteria>
- All tasks completed
- Both components created
- Framer Motion drag logic implemented
- Accessible buttons with proper aria-labels
- No compilation errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-volunteer-swiper/01-03-SUMMARY.md`
</output>
